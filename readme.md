# rewriter.tcl

__rewriter.tcl__ is an experiment in making term rewriting systems. My
goal in this project was to come up with a way of writing a term
rewriting system as a program with nice notation. I think the
experiment is a success. I have come up with a way to write rules
using the abstract redex -> contractum notation; one rule takes one
line.

Right now the system is specific to algebraic expression notation. It
parses infix expressions using the parser in expression.tcl into
abstract syntax trees based on the C++ operator precedence table. I
defined a custom namespace for evaluating these trees as tcl code,
which translates the syntax tree into infix notation for presentation.

The special variables I use in rule definitions are also specific to
algebraic expression notation. The symbols __c, __t, and __a are
available to use to match constants, terms, and atoms (variable names
or constants). This matching is done by defining regular expression
groups for each. I think this part of the system could be pulled out
and generalized so that the user might supply their own special
variables and corresponding groups.

If the parser and the special variable conventions are made general
and definable by the user, I think this system has the potential to
become a useful language for writing term rewriting systems.

## examples

This output is generated by running `tcl test.tcl`. Each left hand
side expression is simplified by the rewrite rules, then evaluated in
a custom namespace to be turned back into infix expressions.

(7 * x) + (8 * x)              ---> 15.0 * x                      
(7 * x) - (8 * x)              ---> -1.0 * x                      
y / y                          ---> 1                             
h * h**4                       ---> h**5.0                        
g**2 * g**3                    ---> g**5.0                        
i * i                          ---> i**2                          
15 * (7 - x)                   ---> 105.0 - 15 * x                
diff(10, x)                    ---> 0                             
diff(sin(y), y)                ---> cos(y)                        
diff(cos(h), h)                ---> -1 * sin(h)                   
diff(y**10, y)                 ---> 10 * y**9.0                   
diff(8 + x, p)                 ---> 0                             
diff((9 - x) + (22 * x), y)    ---> 0                             
diff(r, r)                     ---> 1                             
diff((9 - x) * (22 * x), y)    ---> 0                             
diff(7*x, x)                   ---> 7                             
diff(6 * z**5, z)              ---> 30.0 * z**4.0                 
diff(x, y)                     ---> 0                             
diff(9 - x, y)                 ---> 0                             
diff(22 * x, y)                ---> 0                             
diff(7 - y, y)                 ---> -1 * 1                        
0 + (10 - 7 + x -y)            ---> 3.0 + x - y                   

## usage

rewriter.tcl can be run as an interactive prompt, or as a one-off
program to simplify an expression. Passing the __-e__ option followed
by an expression will print out the simplification of the expression
and exit. Passing no options will drop you into an interactive prompt
where you can input infix expressions and see their simplifications.


<!-- language: lang-none -->

    matt@fitz ~/c/t/trs> ./rewriter.tcl -e 'diff(x*7 + 20*x, x)'
    27.0

    matt@fitz ~/c/t/trs> ./rewriter.tcl
    > 7 + 8*x
    7 + 8 * x
    > 
    > diff(5*sin(x), x)
    5 * cos(x)
    > 
    > h**5 * h**2
    h**7.0
    > quit
